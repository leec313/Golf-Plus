{% extends "base.html" %}
{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Blog Entries Column -->
        <div class="col-12 mt-3 left">
            <div class="row">
                <!-- Checking if a post the user searched for was found - if not return "no posts found"-->
                {% if no_results %}
                <h2 class="text-center mt-3">No posts found.</h2>
                <!-- If posts found, display posts that match criteria -->
                {% elif request.GET.search %}
                <h2 class="text-center mt-3">Search results for: "{{ request.GET.search }}"</h2>
                <!-- Else show the hero carousel and "Latest Blog Posts" heading -->
                {% else %}
                <div class="hero-container">
                    <div class="hero-carousel">
                        <img src="https://res.cloudinary.com/dc9f7ztkr/image/upload/v1698685630/xflcvt9agv2lsnpi88fr.jpg"
                            alt="Scenic View Golf Course">
                        <img src="https://res.cloudinary.com/dc9f7ztkr/image/upload/v1699124451/gttifsmzjclrgninbgtd.jpg"
                            alt="Druid's Glen Golf Course">
                        <img src="https://res.cloudinary.com/dc9f7ztkr/image/upload/v1699124628/oxqs1hkphj6gujv5ajmb.webp"
                            alt="Scenic View of Tralee Golf Course">
                    </div>
                    <a href="{% url 'about' %}">
                        <div class="hero-text">
                            <h2>The Go-To Golf Blog</h2>
                        </div>
                    </a>
                </div>
                <h2 class="text-center mt-3">Latest Blog Posts</h2>
                {% endif %}
                <!-- For loop that displays each blog post on the page in it's own container -->
                {% for post in posts %}
                <div class="col-lg-4">
                    <div class="card mb-4">
                        <a href="{% url 'post_detail' post.slug  %}" aria-label="{{ post.title }}">
                            <div class="card-body">
                                <div class="image-container">
                                    <!-- If there is no image included in the user's blog post, display placeholder -->
                                    {% if "placeholder" in post.featured_image.url %}
                                    <img class="card-img-top" alt=" {{ post.title }} "
                                        src="https://images.unsplash.com/photo-1538648759472-7251f7cb2c2f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2574&q=80">
                                    <!-- Else displays the uploaded image -->
                                    {% else %}
                                    <img class="card-img-top" alt=" {{ post.title }} "
                                        src=" {{ post.featured_image.url }}">
                                    {% endif %}
                                    <div class="image-flash">
                                        <p class="author">Author: {{ post.author }}</p>
                                    </div>
                                </div>
                                <a href="{% url 'post_detail' post.slug  %}" class="post-link"
                                    aria-label="{{ post.title }}">
                                    <h2 class="card-title text-uppercase">{{ post.title }}</h2>
                                    <p class="card-text">
                                        <!-- If the excerpt exceeds 100 characters, it cuts it off -->
                                        {{ post.excerpt|slice:":100" }}{% if post.excerpt|length > 100 %}...{% endif %}
                                    </p>
                                </a>
                                <hr />
                                <div class="card-text h6">
                                    <span class="date-created">{{ post.created_on}}</span>
                                    <span class="likes-comments-container">
                                        <i class="far fa-heart"></i> {{ post.number_of_likes }}
                                        <i class="far fa-comments"></i> {{ post.comments.count }}
                                    </span>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                <!-- checking if the current iteration is a multiple of 3, and if it is, it closes the current row <div class="row"> and opens a new one -->
                {% if forloop.counter|divisibleby:3 %}
            </div>
            <div class="row">
                {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
    <!-- Pagination: as per the PostList view, the page will display only 6 posts per page-->
    {% if is_paginated %}
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <!-- If there is a previous page,  it will display the previous button-->
            {% if page_obj.has_previous %}
            <li><a href="?page={{ page_obj.previous_page_number }}" class="page-link" aria-label="Prev">&laquo;
                    PREV
                </a>
            </li>
            {% endif %}
            <!-- If there are more than 6 posts, it will display the next button-->
            {% if page_obj.has_next %}
            <li><a href="?page={{ page_obj.next_page_number }}" class="page-link" aria-label="NEXT
                    &raquo;"> NEXT
                    &raquo;
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}
    <!-- Includes the newsletter pop up for new users/sessions -->
    {% include 'subscribe_modal.html' %}
</div>
{% endblock %}